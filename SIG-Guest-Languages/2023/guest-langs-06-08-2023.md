## Jun 8, 2023

|          |      | 
| -------- | -------- |
| Attending  | Robin Brown, Joel Dice, Sébastien Deleuze, Timmy Silesmo, Kevin Smith, Dan Gohman, Peter Vetere, Calvin Prewitt, Danny Macovei, Guy Bedford, Saúl Cabrera
| Note Taker | Robin Brown

* Updates
    * Joel: Continuing to work on shared-everything linking using emscryptens format. Got a demo working with 
    * Kevin: Robin, Kevin, and Dan Gohman met about upstreaming Singlestore-Labs/wasix and incorporating our libc stubs into wasi-libc. There are some different approaches to "what happens when you ask for the uid" that we need to make decisions and wasix lets people configure most of this where wasi-libc doesn't. So we'll figure out how to combine them together to make more things compile.
    * Guy: The JS updates for the current bindgen are coming through. To keep the flexibility of the bindings system and work out new namespaces took some work but that should be working soon. If anyone's interested in how bindings get reflected, he's happy to discuss because there are different ways to represent things.
    * Sébastien: Heard the group is now expanding to beyond just dynamic languages and is interested in Java and Kotlin
* [Dan Gohman] - Prototyping handles and resources using a bindings-based implementation
    * https://github.com/bytecodealliance/wit-bindgen/issues/586
    * Dan: Timmy and I are working on a prototype version of this called "pseudo-handles" to make progress on bindings and get method call ergonomics that are missing in wit-bindgen today. It can also handle automatically calling destructors. Timmy has been working on this and has implemented a parser and is working on lifting/lowering.
    * Timmy: Hopefully I will have a lot of time end of this week to spend on that.
    * Dan: The idea here for this sig is that once we have a syntax for this we can talk with all the languages about handles and method syntax. Once we have handles, we won't have to show someone a wit file and apologize. It still won't get full component-component isolatoin but that can catch up.
    *  Sébastien: I know you are working on the resource side. I was wondering who I should talk with for language targetting wasm GC. Is there anyone I can talk with about the missing pieces for languages that target wasm gc?
    *  Dan: Nick F. might be a good person to talk to. 
    *  Dan: There will be some kind of abi that lets you talk to GC languages. I don't know who's been thinking about that.
* [Joel] - Staggering SIG Meetings for Timezone Friendliness
* [Joel] - Known Compatible Versions
    * Joel: Guy has started mapping out compatible versions and we're thinking of taking that to the next level. Python folks are interested in the polyglot side and composing components in different languages. There's interest in a showcase that has components in different languages that work together. This would run in CI and show that things do still work and what's compatible and act as a real world demonstration of what the component model can do and that all these different languages can target it. I want to get people's feedback on this idea and am happy to get started.
    * Robin: Do you know if people in Python are more interested in the client or the server?
    * Joel: I'm interested in the server but I think people are interested in both.
    * Kevin: You could have a version in each language
    * Sébastien: Sometimes there's shared validation logic between the client and the server
    * Robin: I guess more importantly than what the best demo would be, does anyone have time/interest in working on a demo
    * Joel: Ya, I can work on something but I'm not sure when
    * Guy: One thing that was sad was when the online wit-bindgen demo went away. It'd be good if a new demo could... (I think something about achieving what it did).
    * Robin: An online demo might be the best kind of demo because users can run it themselves easily in the browser.
* [Guy] - What is the plan for resources?
    * Guy: In terms of the initial target language work. Is Rust the initial target? and is it going to focus on guest or host first?
    * Dan: There are both sides to it. The main thing we're doing first is reference counting which is the general case. The host will need to provide a reference counting facility which is a global per-store table that will need a reference count entry and it'll need some functionality to increment/decrement in the table on the host side. It should be straightforward when they get to zero drop the entry. The client side can focus on generating the wrapper objects the user can use and calling the increment/decrementing. There's options to have the caller or callee do the increment that have optimization consequences. I'm not too concerned about optimization yet.
    * Guy: 
    * Dan: We do have parsing, the wit-parser implements support for resources. So you can make wit files and parse them.
    * Guy: I might try to do some componentize work and get started. The lifting and lowering is all in the componentize.
    * Joel: When do you think you'll update the preview 2 wit files to this?
    * Dan: As soon as we can, but I'm not sure when that will be. Probably when we have a wasmtime implementation that can run these and a bindings generator probably rust that can make these things. Then I'll encourage everyone to add them because they really are so much better and are a huge improvement.
    * Joel: I imagine this is still TBD, but any thoughts on whether we'd ship preview 2 with this or real resources?
    * Dan: That's complicated and I don't have a full answer. Preview 2 is sort of an abstract thing and there will probably be a vote at some point to declare that we're at preview 2. Independently, many of our companies will do things on their own schedule independent of preview2. Does that mean that preview 2 isn't as urgent? My guess is that we'll implement these pseudo-handles and see how far that gets us and hopefully we'll be in a better place. Part of the strategy here is to parallelize work. We're doing some redundant work but most of this gets reused in the real handle work. So in a few months if people are deciding whether to do full handles we can look at how much work is left and it will come down to what the subgroup thinks. In a way preview 2 is a branding thing as a point where we declare "this is preview 2" which can be whatever we want it to be. I don't want to predict what people will say but my guess is that we don't want to wait a long time for preview 2 and if that means we have to go without full handles we'll do it, but if we can get full handles we would. Historically the plan has always been to have handles and we're adjusting plans to fit things in as they happen. I think we have to have at least pseudo handles because that's the point where I don't have to apologize for wit files, there's more we'll add, but at this point we'll have all the fundamental pieces in place. The cross-component isolation is important but it doesn't have to block other things from happening and it is a preview. It's also going to have other limitations around async. Preview 2 might just be a point this Fall as the date people have in their heads and we'll pull something at that point.
    * Joel: My interest in this is that Preview 2 reaching some level of stability is when we can really invite people to participate and say this is what preview 2 is going to be we can say this is what preview 2 is. I tihnk that's super important for the ecosystem.
    * Dan: Preview 2 is also the point in time where we say from here out we can virtualize things. These pseudo-handles do complicate things and will require a wrapper/adapter component. Getting to the "from here we can all virtualize" which means we can start talking about standardization and the virtualization is why we don't think that's crazy. I've convinced myself that even though pseudo-handles aren't perfect, we can wrap it in a component to make this run in a future version.
    * Joel: On that topic in particular, my concern is that pseudo-resources are a leaky abstraction. Since in theory any component can access any other components resources and people might write applications that makes use of that fact.
    * Dan: One thing we can do is use the bindings to help. If the bindings expose wrappers that hide the u32 from you that is the handle index, then we can establish the way it's used. It's not a complete mitigation but it'll be a big part of it. We can still always virtualize though. Even if people have made a soup of components that link together and know the ids of things, then we can virtualize it by wrapping the whole ball of things in one big component. So on the one hand, we have a number of people here to frame how things work and on the other side if people get clever and write there own bindings or do other stuff, we can virtualize you even if it'll be a big virtualization.
    * Robin: Another thing we can do is implement something like Pointer Authentication Checks where the low-order bits of the handle index are its position in the table and the high order bits are randomly chosen and have to match in order to be used correctly. Even if only some bindings and some host implementations chose to index their tables this way, it can catch other components that aren't doi
    * Dan: I think the social side will be important. We can evangelize this and if we see a pattern emerging, it'll be on us to ask at a social level what problems people are solving and if there are other ways of solving it. We can tell them that it works today but it has less felxibility or other consequences and that this way of working if popular can tell us what people need that we're not giving them. It might be the case that the system we're building here is missing pieces that are needed to do real things in the real world. So if people aren't following the path we expected them to follow it might be that they're trying to do things that we didn't anticipate.
    * Robin: value imports
    * Dan: We should keep our eyes open 
* Action Items
    * Joel: At some point, make an initial demo of some kind
